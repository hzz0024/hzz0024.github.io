---
comments: true
title: C_score to quantify constrained (parallel) evolution
date: '2020-12-10 12:00'
tags:
  - vcf
  - dgconstraint
  - outlier
  - parallel evolution 
categories:
  - CVreseq
---

#### What is C-score?

C-score is a indice that quantify the repeated observation of convergent adaptation [Yeaman et al 2018](https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1007717). Here convergence means overlap genetic variation that arises as a product of multiple routs to adaptation [Laruson et al 2020](https://doi.org/10.1016/j.tree.2020.04.009). High values of the C-score occur with high repeatability, which means that some constraints exist that limit the number of viable genotypes that can give rise to an adaptive phenotype. 

#### How to obtain C-scores?

A null model hypothesizing that no diversity constraints and all genes potentially give rise to variation and contribute to adaptation is needed C-score calculation. Yeaman et al. used different notation to present different properties of the genomic basis of trait variation (with two species as an example):

- the number of loci in the genome of each species is n<sub>x</sub>, and n<sub>y</sub>, with the number of orthologous loci shared by both species being n<sub>s</sub>;         

- the adaptive trait is controlled by g<sub>x</sub> and g<sub>y</sub> loci in each species, with g<sub>s</sub> shared loci (i.e. the loci in which mutations will give rise to phenotypic variation in the trait, hereafter the “mutational target”); 

- of the g loci that give rise to variation, only a subset have the potential to contribute to adaptation due to the combined effect of all constraints, represented by ga<sub>x</sub> and ga<sub>y</sub>, with ga<sub>s</sub> shared loci (the “effective adaptive target”); 

- in a given bout of adaptation, the number of loci that contribute to adaptation in each lineage is a<sub>x</sub> and a<sub>y</sub>, with a<sub>s</sub> orthologous loci contributing in both lineages.

In practice, we typically have little prior knowledge about which genes have the potential to contribute to either adaptation (ga<sub>s</sub>) or standing variation in the trait (g<sub>s</sub>), but we can draw inferences about how these parameters constrain the diversity of adaptive responses by testing hypotheses and comparing the observed amount of overlap (a<sub>s</sub>) to the amount expected under a given null hypothesis (ā<sub>s</sub>), where the expected amount of overlap is ā<sub>s</sub> = a<sub>x</sub>a<sub>y</sub>/ga<sub>s</sub>.

Multiple methods of C-score estimation have proposed:

1) quantify diversity constraints in pairwise contrasts;        
2) quantify diversity constraints in multiple lineages;           
3) quantify diversity constraints with continuous data (e.g., FST, p-values, Bayes factors);        
4) quantify proportion of the genome that can potentially contribute to adaptation          

#### Simple example

<img src="https://hzz0024.github.io/images/C_score/journal.pgen.1007717.g003.PNG" alt="img" width="800"/>

As shown in the example above, four example datasets are generated to represent either randomly drawn complements of genes with adapted mutations (A) or highly convergent datasets drawn from a smaller (B) or larger (C & D) pool of genes that potentially contribute to trait variation (g<sub>s</sub>), with differing numbers of loci contributing to adaptation. Scenario C is the most constrained, as it exhibits the same amount of overlap as B, but this overlap is drawn from a larger pool of genes so it is less likely to occur by chance.

Both the Cchisq and Chyper indices show the highest scores for scenario C, because it has the smallest probability of occurring by chance if all genes had equal probabilities of contributing to adaptation. The index also identifies scenario C as most constrained in terms of the smallest proportion genes potentially contributing to adaptation. The  index also shows that this proportion is equal for scenarios B & D, despite differences in the probability of the observed repeatabilities occurring by chance (as per the C-scores).


